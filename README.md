# Kodo2C_Database_Application
高度情報演習2C，前半木村組4班のデータベースアプリケーション開発リポジトリです

# 開発環境

(國丸の)開発環境は以下のとおりです. これ以上のバージョンであれば問題ないと思います．

- java 16.0.1 2021-04-20
- JavaFX 11.0.2

## エディタ

ビルドパスや実行の構成の都合があるため，Eclipseの使用を推奨します．
VSCodeのJava拡張機能はあまり性能がよくないのでお勧めしません．

## Eclipseの設定


リポジトリをクローンしたらEclipseにインポートしてください．手順としては，プロジェクト一覧が表示されているパースペクティブを右クリックして，メニューからインポートを開いて頑張ってください．

モジュールパスの設定は上級プログラミング2でやったようにしてください．

## 環境変数

JavaFXを使うにあたりいくつか環境変数の設定が必要です．
Javaをインストールした際に設定した項目もあると思いますが，改めて列挙しておきます．

- PATH
  - "<JDKのインストールパス>\bin" を追加
  - "<JavaFXのインストールパス>\bin"を追加
- JAVA_HOME
  - "<JDKのインストールパス>"を追加
- CLASSPATH
  - "<JavaFXのインストールパス>\lib"を追加
- JAVAFX_HOME
  - "<JavaFXのインストールパス>\lib"を追加

## プロジェクトの構成

今のところGUIの外観を把握するためのプロトタイプしか作ってません．
```src``` および ```bin``` フォルダはEclipseではそれぞれソースフォルダ，コンパイル済みの```class``` ファイル置き場の標準的な名前です．
```lib``` フォルダはJavaFXの```lib``` フォルダをそのままコピーしてきたものです．
これは実行の構成の引数でモジュールパスを指定する際，相対パスで指定できればめーばーの環境による差異がなくなるだろうという配慮から作ったものです．
ただし，メンバー全員の環境変数の設定が済んだら，このフォルダは削除して，モジュールパスは環境変数を参照した指定に変えます．

プログラムの構成として現時点で考えているのは，GUI処理およびmainメソッドを含むソース1つとデータベースとの連携をする1つからなるプログラムです．

### 10月31日加筆

プログラムを構成するクラスはまだ増えそうです．
ユーザーの指定した検索条件によって発行するSQL分が変わるため，ユーザが指定した条件を保持するクラスが必要になります．また，TableViewの属性を保持するクラスはメインテーブル用，詳細テーブル用途で2つ必要になりそうです．

## データの収集について

`t_eacharealv`テーブルのデータをうまいこと作るためのプログラムを作りました．シェルスクリプトとJavaを使っているのでJavaが動かせるLinux環境(例えば学情のサーバ，あるいはWSL)で実行してください．

実行方法は

1. MDtoCSV.javaをコンパイルする．
2. tenki.jpの「地震情報」ページのソースから， `<section class="section-wrap"></section>` ～` </section><!-- /.section-wrap -->` で囲まれたテキストを持ってくる（この囲みタグは必要ない）．
3. 2で入手したテキストを[地震コード].txtというファイル名(例えば1.txt)で保存してシェルスクリプトと同じディレクトリに置く．
4. シェルスクリプトにファイル名を引数で渡して実行する．

成功すると[地震コード].csvという形式のファイルができます．


# で，どんなアプリケーションを作るの

地震と，それによって引き起こされた津波の情報を検索できるアプリケーションを作ります．

ウィンドウ上部には検索条件を入力するコンポーネントを用意します．

- 震源地の都道府県での絞り込み
- 日付の範囲検索
- 最大震度の範囲検索
- マグニチュードの範囲検索

一方で画面下半分は

- メインのテーブル
- メインテーブルのレコードをクリックしたときに，その自信のさらに詳細な情報が表示されるテーブル

からなります（津波の情報をどこに表示しましょうか）．

國丸の予定としては11月3日の会議までに

- PostgreSQLとJavaの連携方法の確認
- SQL文発行及び結果取得のプロトタイプ作成
- TableViewのレコードを選択した時のイベントハンドルを確かめるプロトタイプ作成

となります．
